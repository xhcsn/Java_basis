## 1、MyISAM和InnoDB的区别
- MyISAM的只支持表级锁，而InnoDB支持行级锁和表级锁
- MyISAM不支持事务，而InnoDB支持事务，具有提交与回滚的能力
- MyISAM不支持外键，而InnoDB支持外键
- MyISAM不支持数据库异常崩溃后的安全恢复，InnoDB引擎的数据库在异常崩溃以后，数据库可以通过redo logo进行数据库恢复

## 2、InnoDB存储引擎的三种锁算法
- 记录锁：单个行记录上的锁
- 间隙锁：锁起来一个范围，不包括记录本身
- 临键锁：相当于是记录锁＋间隙锁，锁定一个范围并且包括记录本身

## 3、什么是数据库事务
数据库事务是对多个数据库的操作构成一个逻辑上的整体。构成这个逻辑上的整体的这些数据库操作要么全部执行要么全部不执行

## 4、ACID特性
- 原子性：事务是最小的执行单位，不允许分割，要么全部执行要么全部不执行
- 一致性：执行事务前后数据保持一致
- 隔离性：并发访问数据库的时候，事务之间不会互相干扰
- 持久性：一个事务被提交后，对数据库的改变是持久的，即使数据库发生故障也不应该有任何影响

## 5、并发事务带来的问题
- 脏读：当A事务正在访问数据并且对数据进行了修改，而这种修改还没有提交到数据库的时候，B事务也访问到这个数据，然后使用这个数据，当A事务进行了回滚，B事务读到了脏数据
- 丢失修改：当A事务修改了A数据为自减，当B事务修改了A数据也为自减，那么A事务的修改丢失了
- 不可重复读：A事务读到了A数据，B事务修改了A数据，A事务再读就读不到之前的数据
- 幻读：A事务读取了5行数据，B事务进行增删操作，A事务再次读取的时候行数不一样，称为幻读

## 6、事务的隔离级别
- 读取未提交：最低的隔离级别，允许读取尚未提交的数据变更，可能会导致脏读、幻读或不可重复读。
- 读取已提交：允许读取并发事务已经提交的数据，可以阻止脏读，但是幻读或不可重复读仍有可能发生。
- 可重复读：对同一字段的多次读取结果都是一致的，除非数据是被本身事务自己所修改，可以阻止脏读和不可重复读，但幻读仍有可能发生。也是InnoDB引擎的默认隔离级别
- 可串行化：最高的隔离级别，完全服从ACID的隔离级别。所有的事务依次逐个执行，这样事务之间就完全不可能产生干扰，也就是说，该级别可以防止脏读、不可重复读以及幻读。

InnoDB的可重读并不保证避免幻读，需要应用使用加锁读来保证。而这个加锁度使用到的机制就是Next-Key Locks。

## 7、何为索引
索引是一种用于快速查询和检索数据的数据结构。常见的索引结构有：B树、B+树和Hash

优点：
- 使用索引可以大大加快数据的检索速度，也是创建索引的主要原因。
- 通过创建唯一性索引，可以保证数据库表中每一行数据的唯一性
缺点：
- 创建索引和维护索引需要耗费许多时间。当对表中的数据进行增删改的时候，如果数据有索引，那么 索引也需要动态的修改，会降低SQL执行的效率。
- 索引需要使用物理文件存储，也会耗费一定空间。

## 8、索引的底层数据结构
#### MySQL为什么没有使用Hash表作为索引
- Hash冲突问题
- Hash索引不支持顺序和范围查询
#### B树和B+树的异同
- B树的所有节点既存放键，也存放数据，而B+树只有叶子节点存放key和data，其他节点只存放key
- B树的叶子节点都是独立的；B+树的叶子节点有一条引用链指向与它相邻的叶子节点。
- B树的检索的过程相当于对范围内的每个节点的关键字做二分查找，可能还没有到达叶子节点，检索就结束了。而B+树的检索效率就很稳定了，任何查找都是从根节点到叶子节点的过程，叶子节点的顺序检索很明显。

## 9、主键索引和二级索引
一张数据表只能有一个主键，并且主键不能为null，不能重复。在MySQL的InnoDB的表中，当没有显示的指定表的主键时，InnoDB 会自动先检查表中是否有唯一索引的字段，如果有，则选择该字段为默认的主键，否则 InnoDB 将会自动创建一个 6Byte 的自增主键。

二级索引又称为辅助索引，是因为二级索引的叶子节点存储的数据是主键。也就是说，通过二级索引，可以定位主键的位置。

唯一索引，普通索引，前缀索引等索引属于二级索引。

## 10、聚集索引和非聚集索引
聚集索引即索引结构与数据一起存放的索引。主键索引属于聚集索引。

聚集索引的查询速度非常的快，因为整个 B+树本身就是一颗多叉平衡树，叶子节点也都是有序的，定位到索引的节点，就相当于定位到了数据。

聚集索引的缺点在于：
- 依赖于有序的数据 ：因为 B+树是多路平衡树，如果索引的数据不是有序的，那么就需要在插入时排序，如果数据是整型还好，否则类似于字符串或 UUID 这种又长又难比较的数据，插入或查找的速度肯定比较慢。
- 更新代价大 ： 如果对索引列的数据被修改时，那么对应的索引也将会被修改， 而且况聚集索引的叶子节点还存放着数据，修改代价肯定是较大的， 所以对于主键索引来说，主键一般都是不可被修改的。

非聚集索引即索引结构和数据分开存放的索引。更新的代价比聚集索引小

二级索引属于非聚集索引。

非聚集索引的缺点：
- 跟聚集索引一样，非聚集索引也依赖于有序的数据
- 可能会回表查询(覆盖索引) :这应该是非聚集索引最大的缺点了。 当查到索引对应的指针或主键后，可能还需要根据指针或主键再到数据文件或表中查询。

## 11、非聚集索引一定回表查询吗(覆盖索引)?
非聚集索引不一定回表查询。当查询语句查询的就是索引本身就不需要回表查询

## 12、覆盖索引
如果一个索引包含所有需要查询的字段的值就称之为覆盖索引。覆盖索引即是查询的字段刚好是索引的字段，就可以根据该索引查询到数据，而无需进行回表查询

## 13、MySQL基本架构
MySQL分为Server层和存储引擎层：
- Server层：主要包括连接器、查询缓存、分析器、优化器、执行器等，所有跨存储引擎的功能都在这一层实现
- 存储引擎：主要负责数据的存储和读取，采用可以替换的插件式架构，支持InnoDB、MyISAM、Memory等多个存储引擎

## 14、Server层组件介绍
#### 连接器
连接器主要和身份认证和权限相关的功能相关
#### 查询缓存(MySQL 8.0 版本后移除)
查询缓存主要用来缓存我们所执行的 SELECT 语句以及该语句的结果集。
#### 分析器
分析器主要是用来分析 SQL 语句是来干嘛的，分析器也会分为几步：
- 词法分析，一条SQL语句有多个字符串组成，首先要提取关键字，比如select，提出查询的表，提出字段名，提出查询条件等等。
- 语法分析，主要就是判断你输入的 sql 是否正确，是否符合 MySQL 的语法。
#### 优化器
优化器的作用就是它认为的最优的执行方案去执行，比如多个索引的时候该如何选择索引，多表查询的时候如何选择关联顺序等。
#### 执行器
当选择了执行方案后，MySQL 就准备开始执行了，首先执行前会校验该用户有没有权限，如果没有权限，就会返回错误信息，如果有权限，就会去调用引擎的接口，返回接口执行的结果。

## 15、